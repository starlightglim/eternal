# EternalOS Worker Configuration
# See https://developers.cloudflare.com/workers/wrangler/configuration/

name = "eternalos-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Durable Objects
[[durable_objects.bindings]]
name = "USER_DESKTOP"
class_name = "UserDesktop"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["UserDesktop"]

# KV Namespaces
[[kv_namespaces]]
binding = "AUTH_KV"
id = "181861d860e5441a9467effa18a6fa16"

[[kv_namespaces]]
binding = "DESKTOP_KV"
id = "90801c76cfcb483c8dc6f6123ed8f79a"

# R2 Bucket (local dev uses Miniflare simulation)
# For production: wrangler r2 bucket create eternalos-files
[[r2_buckets]]
binding = "ETERNALOS_FILES"
bucket_name = "eternalos-files"

# Workers AI
[ai]
binding = "AI"

# JWT_SECRET is set via: wrangler secret put JWT_SECRET
# For local dev, set JWT_SECRET in .dev.vars file

# Scheduled triggers (cron jobs)
# Clean up old trashed items daily at 3:00 AM UTC
[triggers]
crons = ["0 3 * * *"]

# Development settings
[dev]
port = 8787
local_protocol = "http"
